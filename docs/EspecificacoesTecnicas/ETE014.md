# Especificação Técnica 014 - Cadastrar Entes / Instituições

## Descrição da funcionalidade <!-- Dúvida: É só "Descrição", "Funcionalidade" ou "Descrição de funcionalidade"? -->
Eu como Administrador de uma instância do e-SUS AF, desejo cadastrar um ente/instituição ao sistema, para que o mesmo possa ser utilizado por essa instituição ou ente. 

## Protótipo 001

### Descrição resumida

Cadastro de entres – Permite o cadastro do ente para que o sistema possa ser utilizado na esfera federal, estadual, municipal e ou por instituições. 

[Inserir imagem] <!-- [Protótipo Adobe XD](https://xd.adobe.com/view/73019e8a-bbd1-40fe-9f30-14e5c4740fe1-2652/) -->

### Acesso
Menu lateral > Configuração > Cadastro de entes > Acionar o botão “novo”

### Campos

Esfera de gestão= selecionar

* Federal = Gestão que engloba todos Entes/Instituições do país
* Estadual = Gestão que engloba todos Entes/Instituições na esfera de um estado
* Municipal = Gestão que engloba todos Entes/Instituições de determinado município
* Entidade/instituição = Gestão que engloba um Ente/Instituição

Esfera Federal
<!-- DÚVIDA: "Caixa seleção"-->
|UF|Município|CNPJ|Nome Fantasia|
|--|---------|----|-------------|
|Caixa seleção|Caixa seleção|Pesquisa|Obrigatório (importa dados do CNPJ)|

Esfera Estadual

|UF|
|--|
|Caixa seleção|

Esfera Municipal

|UF|Município|
|--|---------|
|Caixa seleção|Caixa seleção|

Esfera Entidade/Instituição

|CNPJ|Nome Fantasia|
|----|-------------|
|Pesquisa|Obrigatório (importa dados do CNPJ)|


### Elementos de Tela: <!--Texto tachado é para apagar? -->
* ~~Bread Crumb – “Configuração / Cadastro de Entes / Cadastro”~~
* ~~Título da página – “Cadastrar Ente”~~
* ~~– M - retorna para a Tela Consultar Entes~~
* ~~“Consultar” – BT - retorna para a Tela Consultar Entes~~
* ~~UF – SU~~
* ~~Município – SU~~
* ~~CNES – N (7)~~
* ~~“Cadastrar” – BT~~
* ~~“Limpar” – BT~~

**Legenda**  
~~TIPO: A = Alfanumérico, N = Numérico, D = Data, M = Imagem, BT = Botão, LK = Link, SU = Seleção Única, SM = Seleção Múltipla, AC = Autocomplete, * = Obrigatório.~~

### Critérios de aceite <!-- Revisar as MSG do 7, 8 e 10 -->

1. Apenas um usuário com perfil de administrador poderá acessar a funcionalidade de "Cadastro de entes/instituições"; 
2. No campo de busca, ao inserir pelo menos um caractere, ao clicar na lupa, o sistema reporta com os resultados encontrados; 
3. O sistema deverá permitir a visualização de todos os entes/instituições cadastrados, com a possibilidade de filtrar por nome, CNPJ e status (Ativo/Inativo);
4. Caso o ente/instituição não seja localizado na lista dos cadastrados, deve-se clicar no botão “Novo” e efetuar o cadastro conforme ETE014; 
5. O sistema deverá permitir a inativação de entes/instituições, sem excluir os dados já cadastrados; 
6. O sistema deverá permitir a reativação de entes/instituições inativos; 
7. Quando o usuário acionar a opção “Ativar”, o sistema deve apresentar mensagem de confirmação ao usuário. Caso o usuário confirme a ação, o sistema deve ativar a participação do ente e apresentar a mensagem de sucesso. Caso a ação não seja confirmada, o sistema permanece na tela de consulta;  [MSG066](DocumentoDeMensagensv2.md#msg066) [MSG068](DocumentoDeMensagensv2.md#msg068)
8. Quando o usuário acionar a opção “Inativar”, o sistema deve apresentar mensagem de confirmação ao usuário. Caso o usuário confirme a ação, o sistema deve inativar a participação do ente e apresentar a mensagem de sucesso. Caso a ação não seja confirmada, o sistema permanece na tela de consulta; [MSG067](DocumentoDeMensagensv2.md#msg067) [MSG069](DocumentoDeMensagensv2.md#msg069) 
9. O sistema deverá garantir que usuários não consigam acessar estabelecimentos de Entes na situação Inativo;
10. O sistema deve gravar a data, hora e CPF e nome do usuário que a executou qualquer ação de alteração no registro. [RGN005](DocumentoDeRegrasv2.md#rgn005) 
11. Quando o usuário acionar a seta para cima ao lado do título da página, o sistema deve retornar à tela inicial do sistema (dashboard). 


## Modelo de Dados

| Nível | Atributo          | Descrição                                                                     | Cardinalidade | Tipo de Dado | Tamanho | Formato / Observação                                                  |
|:------|:------------------|:------------------------------------------------------------------------------|:--------------|:-------------|:--------|:----------------------------------------------------------------------|
| 1     | Identificador     | Código sequencial que identifica univocamente um ente/instituição no e-SUS AF | (1, 1)        | number       | -       | -                                                                     |
| 1     | Esfera de Gestão  | Campo enumerado contendo os valores da esfera de gestão                       | (1, 1)        | string       | 100     | M - Municipal, E - Estadual, F - Federal e I - Entidade / Instituição |
| 1     | Código da UF      | Código da Unidade de Federação conforme TB_UF                                 | (0, 1)        | number       | -       | Código da Unidade da Federação (Obrigatório Para Esfera E / M)        |
| 1     | Código Município  | Código do Município conforme TB_MUNICIPIO                                     | (0, 1)        | number       | -       | Código do município (Obrigatório Para Esfera M)                       |
| 1     | CNPJ              | Número do CNPJ da instituição que passará a usar o e-SUS AF                   | (0, 1)        | string       | 14      | Deve ser obrigatório para Entidades/Instituições                      |
| 1     | Nome Fantasia     | Nome Fantasia da entidade/instituição                                         | (0, 1)        | string       | 120     | Deve ser obrigatório para Entidades/Instituições                      |
