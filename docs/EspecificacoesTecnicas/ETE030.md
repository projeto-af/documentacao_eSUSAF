# ETE030 - Cadastrar Usuário SUS

## Descrição 
Como usuário quero cadastrar um usuário SUS no sistema, uma vez que seja possível a localização deste no portal do CADSUS, através da informação do seu CPF.   

## Protótipo 001

![alt text](../imagens/ete-030-prot-001.png) <!-- Não sei se já foi alterada -->

### Acesso 
Menu lateral > Cadastro > Usuário SUS > Botão Novo 

### Critérios de Aceite 
1. O usuário somente pode acessar a funcionalidade caso tenha permissão. [RGN001](DocumentoDeRegrasv2.md#rgn001); 
2. Quando o usuário informar o CPF ou CNS e acionar a opção “Lupa”, o sistema deve: 
      * Verificar se o CPF é valido. Em caso positivo, recuperar as informações da API - integração com o portal do Cadastro Nacional de Usuários do Sistema Único de Saúde (CADSUS) - e apresentar os dados: nº do CPF, nº do Cartão Nacional do SUS (CNS), Nome Completo, Nome social, Nome completo da mãe, Data de Nascimento, Sexo, Raça, e-mail, Celular, País de origem, Estado de origem, Município de origem.   
      * Apresentar uma mensagem de alerta ao usuário caso a consulta do CPF não retorne um Usuário SUS válido;
3. O sistema deve permitir incluir um responsável pelo Usuário SUS, conforme: 
      * A inclusão de um responsável pelo Usuário SUS não é obrigatória; 
      * Pode ser incluído um ou mais responsáveis pelo Usuário SUS; 
      * O(s) responsável(is) incluído(s) não pode(m) ser excluído(s), apenas inativados ou editados; 
      * É necessário informar o nº do CPF e nome completo, sendo opcional o nº do celular e e-mail do responsável.
4. Quando o usuário acionar a opção de “Cadastrar”, o sistema verifica se o preenchimento das informações atende às validações listadas, efetiva o cadastro do Usuário SUS, grava o estado como “Ativo” e a situação do registro como “Cadastrado” e habilita as abas “Endereço do Paciente”, “Responsáveis pelo Usuário SUS” e “Observações” 
5. O sistema não deve permitir incluir um responsável com o mesmo nº de CPF de um já relacionado;
6. Quando o usuário acionar a opção “incluir” o sistema deve: 
      * Incluí-lo na relação dos responsáveis pelo usuário SUS; 
      * Apresentar a relação dos responsáveis incluídos com as ações desejáveis para cada registro. 
7. Quando o usuário acionar a opção “Editar” em um registro de um responsável, o sistema carrega os dados informados anteriormente e permite alterar somente o número de telefone do responsável; 
8. Quando o usuário acionar a opção “Inativar”, em um registro de um responsável, o sistema deve inativá-lo da lista de responsáveis pelo usuário SUS; 
9. O sistema deve permitir incluir observações ao cadastro do Usuário SUS, conforme: 
      * A indicação de uma observação não é obrigatória; 
      * Pode ser incluída uma ou mais observações para o Usuário SUS; 
      * A(s) observação(ões) incluída(s) pode(m) ser excluída(s).
10. Para a inclusão de uma ou mais observações ao cadastro do Usuário SUS, o usuário deve informar o detalhe da observação; 
11. Quando o usuário acionar a opção “incluir” o sistema deve: 
    *  Incluí-la na relação das observações; 
    * Apresentar o nome completo do usuário do sistema que a incluiu e a data e hora da inclusão;
    * Apresentar a lista de observações em ordem cronológica decrescente (da última à primeira). 
12. Quando o usuário acionar a opção “Editar”, em um registro de uma observação, o sistema carrega os campos com os dados informados anteriormente e permite a edição; 
13. Quando o usuário acionar a opção “Excluir”, em um registro de uma observação, o sistema deve exclui-la da lista das observações do usuário SUS; 
14. Quando o usuário acionar a opção de “Voltar” ou “Consultar”, o sistema retorna à tela de consulta aos Usuários SUS e não salva as edições realizadas.
15. O sistema deve gravar a data, hora e CPF e nome do usuário que a executou qualquer ação de alteração no estado do registro. [RGN005](DocumentoDeRegrasv2.md#rgn005). 