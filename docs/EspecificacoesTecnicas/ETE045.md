# ETE045 - Consultar Dispensação <!-- Estou criando do zero este .md de acordo com o docx. -->

## Descrição da funcionalidade 

Como usuário quero consultar a(s) dispensação(ões) de produto(s) realizada(s) no estabelecimento de saúde logado. 

## Protótipo 001 

### Descrição resumida  
Consultar dispensação- Permite consultar a(s) dispensação(ões) de produto(s) realizada(s) no estabelecimento de saúde logado. 

### Acesso
Menu lateral > Dispensação/Fornecimento > Consultar 

### Critérios de Aceite 

1. O usuário somente poderá acessar a funcionalidade caso tenha permissão. [RGN001](DocumentoDeRegrasv2.md#rgn001); 
2. Quando o usuário acessar a funcionalidade, o sistema deve apresentar os filtros de pesquisa e somente apresentar a lista de resultado da consulta quando a opção “Consultar” for acionada;  
3. Quando o campo “Nº da Dispensação” for informado, ao clicar em “Consultar” o sistema deve: 
    - Validar se a Dispensação/Fornecimento informada foi encontrada, listando as informações na tela. Caso não, o sistema deve realçar o campo e alertar ao usuário;  
    - Apresentar a lista de registros de Dispensação/Fornecimento que correspondam ao valor informado no campo. 
4. Quando o campo “CPF do usuário SUS” for informado, ao clicar em “Consultar” o sistema deve: 
    - Validar se o documento informado localizou uma Dispensação/Fornecimento. Caso não localize, o sistema deve realçar o campo e alertar ao usuário; 
    - Apresentar a lista de registros de Dispensação/Fornecimento que correspondam ao documento informado, listando e ordenando, por data de dispensação, do mais recente ao mais antigo. 
5. Quando o campo “Produto” for informado, ao clicar em “Consultar” o sistema deve: 
    - Apresentar a lista de produtos ativos no sistema que correspondam ao valor informado no campo autocomplete a partir da indicação do 3º caractere, consultando por nome do produto ou princípio ativo do medicamento; 
    - Validar se para o produto informado foi encontrado alguma Dispensação/Fornecimento. Caso não, o sistema deve realçar o campo e alertar ao usuário; 
    - Recuperar e listar a(s) Dispensação(ões)/Fornecimento(s) realizada(s) com o produto em questão, trazendo os dados na tela, ordenando, por data de dispensação, do mais recente ao mais antigo. 
6. Quando os campos “Data início” e “Data fim” forem informados, ao clicar em “Consultar” o sistema deve: 
    - Verificar se o período informado é válido.  Caso não, o sistema deve realçar o campo e alertar ao usuário;  
    - Recuperar e listar a(s) Dispensação(ões)/Fornecimento(s) realizado(s) no período informado, trazendo os dados na tela, ordenando, por data de dispensação, do mais recente ao mais antigo. 
7. Quando o campo “Situação” for informado, o sistema deve apresentar as opções: Em preenchimento, Dispensado e Estornado. Ao clicar em “Consultar” o sistema deve: 
    - Verificar se há dispensações na situação desejada.  Caso não, o sistema deve realçar o campo e alertar ao usuário; 
    - Recuperar e listar a(s) Dispensação(ões)/Fornecimento(s) na situação desejada, trazendo os dados na tela, ordenando, por data de dispensação, do mais recente ao mais antigo. 
8. Quando o usuário acionar a opção “Consultar”, o sistema deve recuperar e apresentar o(s) registro(s) de Dispensação/Fornecimento do estabelecimento logado de acordo com o(s) filtro(s) informado(s);  
9. Caso não seja informado nenhum filtro, o sistema deve recuperar e apresentar todo(s) o(s) registro(s) de dispensação do estabelecimento logado;  
10. O sistema, não encontrando a(s) entrada(s) para os filtros informados, deve informar que o(s) registro(s) não foram encontrados; 
11. O sistema deve permitir Excluir, Editar, Estornar ou Detalhar um registro de dispensação;  
12. O sistema deve apresentar as ações conforme:  
    a) Para registro com situação “Em preenchimento”, as opções “Excluir”, “Editar” e “Detalhar”;    
    b) Para registro com situação “Dispensado”, as opções “Estornar” e “Detalhar”;  
    c) Para registro com situação “Estornado” apenas a opção “Detalhar”.  
13. Quando o usuário acionar a opção “Novo”, o sistema deve direcionar para a tela de cadastro de uma nova Dispensação; 
14. Quando o usuário acionar a opção “Limpar”, o sistema deve limpar o(s) filtro(s) informado(s), o resultado da consulta e permanecer na tela de consultar dispensação;   
15. Quando o usuário acionar a opção “Voltar”, o sistema deve retornar para a tela inicial do sistema (dashboard);  
16. Quando o usuário acionar a opção “Editar”, o sistema deve direcionar para a tela de edição de uma Dispensação; 
17. Quando o usuário acionar a opção “Excluir”, o sistema deve apresentar a mensagem de confirmação ao usuário. Caso o usuário confirme a ação, o sistema deve excluir o registro da dispensação e deixar de apresentá-lo no resultado da consulta. Caso a ação não seja confirmada, o sistema permanece na tela de consulta. A exclusão física somente será possível para dispensação(ões) com situação “Em preenchimento”;  
18. Quando o usuário acionar a opção “Estornar”, o sistema deve direcionar para a tela de Estorno. 

 